<html>
  <body>
    <script>
    let ignoredDirs = ["tiles_png", "mp3"];

    async function fetchWithRetry(url) {
        const response = await fetch(url);
        const data = await response.json();
        console.log(data);
        let htmlString = '<ul>';
        for (let file of data) {
          if(file.type == "dir" && !ignoredDirs.includes(file.name)){
            fetchWithRetry("https://api.github.com/repos/hsbe/hsbe.github.io/contents/"+file.path);
          }else if(file.type == "file" && file.name.endsWith(".json") )
          htmlString += `<li><a href="${file.path}">${file.name}</a></li>`;
        }
        htmlString += '</ul>';

        document.getElementById("data").innerHTML += htmlString;



    }

    fetchWithRetry("https://api.github.com/repos/hsbe/hsbe.github.io/contents/");


/*
    getData("https://api.github.com/repos/hsbe/hsbe.github.io/contents/")
      .then(data => {
          console.log(data); // JSON data parsed by `data.json()` call

          let htmlString = '<ul>';
          for (let file of data) {
            if(file.type == "dir"){

            }else if(file.type == "file" && file.name.endsWith(".json"))
            htmlString += `<li><a href="${file.path}">${file.name}</a></li>`;
          }
          htmlString += '</ul>';

          document.getElementById("data").innerHTML = htmlString;
    });


*/








    /*
      (async () => {
        const response = await fetch('https://api.github.com/repos/hsbe/hsbe.github.io/contents/');
        const data = await response.json();
        let htmlString = '<ul>';
        for (let file of data) {
          if(file.type == "file" && file.name.endsWith(".json"))
          htmlString += `<li><a href="${file.path}">${file.name}</a></li>`;
        }
        htmlString += '</ul>';
        document.getElementsByTagName('body')[0].innerHTML = htmlString;
      })()
*/

    </script>
    <div id="data"></div>
  <body>
</html>
